<!--  Replace menu links here -->
<!-- Redundant home link
<li class="nav-item">
  <a class="nav-link" href="{{site.baseurl}}/index.html">Home</a>
</li>
-->
<!-- LUNAR HERE INSTEAD -->
<script src="{{site.baseurl}}/assets/js/lunr.js"></script>
<script>
   $(function() {
       $("#lunrsearchresults").on('click', '#btnx', function () {
           $('#lunrsearchresults').hide( 1000 );
           $( "body" ).removeClass( "modal-open" );
       });
   });
       
   {% assign counter = 0 %}
   var documents = [{% for page in site.pages %}{% if page.url contains '.xml' or page.url contains 'assets' %}{% else %}{
       "id": {{ counter }},
       "url": "{{ site.url }}{{site.baseurl}}{{ page.url }}",
       "title": "{{ page.title }}",
       "body": "{{ page.content | markdownify | replace: '.', '. ' | replace: '</h2>', ': ' | replace: '</h3>', ': ' | replace: '</h4>', ': ' | replace: '</p>', ' ' | strip_html | strip_newlines | replace: '  ', ' ' | replace: '"', ' ' }}"{% assign counter = counter | plus: 1 %}
       }, {% endif %}{% endfor %}{% for page in site.without-plugin %}{
       "id": {{ counter }},
       "url": "{{ site.url }}{{site.baseurl}}{{ page.url }}",
       "title": "{{ page.title }}",
       "body": "{{ page.content | markdownify | replace: '.', '. ' | replace: '</h2>', ': ' | replace: '</h3>', ': ' | replace: '</h4>', ': ' | replace: '</p>', ' ' | strip_html | strip_newlines | replace: '  ', ' ' | replace: '"', ' ' }}"{% assign counter = counter | plus: 1 %}
       }, {% endfor %}{% for page in site.posts %}{
       "id": {{ counter }},
       "url": "{{ site.url }}{{site.baseurl}}{{ page.url }}",
       "title": "{{ page.title }}",
       "body": "{{ page.date | date: "%Y/%m/%d" }} - {{ page.content | markdownify | replace: '.', '. ' | replace: '</h2>', ': ' | replace: '</h3>', ': ' | replace: '</h4>', ': ' | replace: '</p>', ' ' | strip_html | strip_newlines | replace: '  ', ' ' | replace: '"', ' ' }}"{% assign counter = counter | plus: 1 %}
       }{% if forloop.last %}{% else %}, {% endif %}{% endfor %}];
   
   var idx = lunr(function () {
       this.ref('id')
       this.field('title')
       this.field('body')
   
       documents.forEach(function (doc) {
           this.add(doc)
       }, this)
   });
   
   
       
   function lunr_search(term) {
       $('#lunrsearchresults').show( 1000 );
       $( "body" ).addClass( "modal-open" );
       
       document.getElementById('lunrsearchresults').innerHTML = '<div id="resultsmodal" class="modal show d-block"  tabindex="-1" role="dialog" aria-labelledby="resultsmodal"> <div class="modal-dialog shadow-lg" role="document"> <div class="modal-content"> <div class="modal-header" id="modtit"> </button> </div> <div class="modal-body"> <ul class="mb-0"> </ul>    </div> <div class="modal-footer"><button id="btnx" type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Close</button></div></div> </div></div>';
       if(term) {
           document.getElementById('modtit').innerHTML = "<h5 class='modal-title'>Search results for '" + term + "'</h5>" + document.getElementById('modtit').innerHTML;
           //put results on the screen.
           var results = idx.search(term);
           if(results.length>0){
               //console.log(idx.search(term));
               //if results
               for (var i = 0; i < results.length; i++) {
                   // more statements
                   var ref = results[i]['ref'];
                   var url = documents[ref]['url'];
                   var title = documents[ref]['title'];
                   var body = documents[ref]['body'].substring(0,160)+'...';
                   document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML = document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML + "<li class='lunrsearchresult'><a href='" + url + "'><span class='a.text-dark'>" + title + "</span><br /><small><span class='body'>"+ body +"</span><br /><span class='url'>"+ url +"</span></small></a></li>";
               }
           } else {
               document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML = "<li class='lunrsearchresult'>Sorry, no results found. Close & try a different search!</li>";
           }
       }
       return false;
   }
</script>

<!-- LUNAR END -->
<li class="nav-item">
  <a class="nav-link" href="{{site.baseurl}}beginners">Beginners</a>
</li>

<li class="nav-item">
  <a class="nav-link" href="{{site.baseurl}}tak">ASN-TAK</a>
</li>

<li class="nav-item">
  <a class="nav-link" href="{{site.baseurl}}resources">Resources</a>
</li>

<li class="nav-item">
  <a class="nav-link" href="{{site.baseurl}}guides">Guides</a>
</li>

<li class="nav-item">
  <a class="nav-link" href="{{site.baseurl}}authors">Authors</a>
</li>

<!-- 
hardcoded links, &nbsp; for extra air
-->
<li class="nav-item" style="padding-left:15px;padding-right:15px;">
    <a href="https://discord.gg/gMegmXMAPN" target="_blank"><i class="fab fa-discord" aria-hidden="true"></i></a>&nbsp;
    <a href="https://www.youtube.com/channel/UC0jdeJCXXosXPuwOcTH1MAA" target="_blank"><i class="fab fa-youtube" aria-hidden="true"></i></a>&nbsp;
    <a href="https://www.facebook.com/AirsoftNorge" target="_blank"><i class="fab fa-facebook" aria-hidden="true"></i></a>&nbsp;
    <a href="mailto:staff.airsoftnorge@gmail.com" target="_blank"><i class="fa fa-envelope" aria-hidden="true"></i></a>&nbsp;
</li>

<li class="nav-item">
	<form class="hidden-sm-down" onSubmit="return lunr_search(document.getElementById('lunrsearch').value);">
		<input type="text" class="searchack text-small"  id="lunrsearch" name="q" value="" placeholder="Type keyword and enter..."> 
	</form>
</li>
